@let elem = element();

<mat-label>{{ elem.label }}</mat-label>
<mat-form-field [style]="elem.width ? { width: elem.width } : { width: '100%' }">
  @if (elem.autoComplete) {
    <input
      type="text"
      matInput
      [placeholder]="elem.placeholder || ''"
      [required]="elem.required || false"
      [readonly]="elem.readonly || false"
      [hidden]="elem.hidden || false"
      [formControl]="control()"
      [matAutocomplete]="auto"
    />
    <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
      @for (option of filteredOptions | async; track option) {
        <mat-option [title]="option.label" [value]="option.key">{{ capitalizeWords(option.label) }}</mat-option>
      }
    </mat-autocomplete>
  } @else {
    <mat-select
      [formControl]="control()"
      hideSingleSelectionIndicator
      [multiple]="elem.allowMultiple || false"
      [placeholder]="elem.placeholder || ''"
      [required]="elem.required || false"
      [hidden]="elem.hidden || false"
    >
      @if (elem.allowMultiple) {
        <mat-select-trigger>
          {{ control().value?.[0] || '' }}
          @if ((control().value?.length || 0) > 1) {
            <span>
              (+{{ (control().value?.length || 0) - 1 }} {{ control().value?.length === 2 ? 'other' : 'others' }})
            </span>
          }
        </mat-select-trigger>
      }
      @if (options().length == 0 && elem.categoriesList?.length) {
        @for (group of elem.categoriesList; track group.category) {
          <mat-optgroup [label]="group.category" [disabled]="group.disabled">
            @for (option of group.options; track option) {
              <mat-option [title]="option.label" [value]="option.key">{{ capitalizeWords(option.label) }}</mat-option>
            }
          </mat-optgroup>
        }
      } @else {
        @for (option of options(); track option.key) {
          <mat-option [title]="option.label" [value]="option.key">{{ capitalizeWords(option.label) }}</mat-option>
        }
      }
    </mat-select>
  }
  @if (control().errors) {
    <mat-error>
      <sc-error [element]="elem" [errors]="control().errors"></sc-error>
    </mat-error>
  }
  @if (elem.hint) {
    <mat-hint>{{ elem.hint }}</mat-hint>
  }
</mat-form-field>
